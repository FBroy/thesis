[{
    "data": {
        "id": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851",
        "type": "file",
        "links": {
            "self": "https://www.virustotal.com/api/v3/files/c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
        },
        "attributes": {
            "names": [
                "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe",
                "c46df827f06ffa3f144713fa6ee077e8_wannacry.exe",
                "2023-04-27_c46df827f06ffa3f144713fa6ee077e8_wannacry",
                "c46df827f06ffa3f144713fa6ee077e8.virus"
            ],
            "detectiteasy": {
                "filetype": "PE32",
                "values": [
                    {
                        "info": "EXE32",
                        "version": "6.0 (1720-9782)",
                        "type": "Compiler",
                        "name": "EP:Microsoft Visual C/C++"
                    },
                    {
                        "info": "msvcrt",
                        "version": "6.0",
                        "type": "Compiler",
                        "name": "Microsoft Visual C++"
                    },
                    {
                        "info": "C++",
                        "version": "12.00.9782",
                        "type": "Compiler",
                        "name": "Microsoft Visual C/C++"
                    },
                    {
                        "version": "6.00.8047",
                        "type": "Linker",
                        "name": "Microsoft Linker"
                    },
                    {
                        "version": "6.0",
                        "type": "Tool",
                        "name": "Visual Studio"
                    }
                ]
            },
            "trid": [
                {
                    "file_type": "Win32 Executable MS Visual C++ (generic)",
                    "probability": 37.8
                },
                {
                    "file_type": "Microsoft Visual C++ compiled executable (generic)",
                    "probability": 20.0
                },
                {
                    "file_type": "Win64 Executable (generic)",
                    "probability": 12.7
                },
                {
                    "file_type": "Win32 Dynamic Link Library (generic)",
                    "probability": 7.9
                },
                {
                    "file_type": "Win16 NE executable (generic)",
                    "probability": 6.1
                }
            ],
            "meaningful_name": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe",
            "type_description": "Win32 EXE",
            "type_tags": [
                "executable",
                "windows",
                "win32",
                "pe",
                "peexe"
            ],
            "last_analysis_results": {
                "Bkav": {
                    "method": "blacklist",
                    "engine_name": "Bkav",
                    "engine_version": "2.0.0.1",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "W32.WannaCryptTTc.Worm"
                },
                "Lionic": {
                    "method": "blacklist",
                    "engine_name": "Lionic",
                    "engine_version": "7.5",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Win32.Wanna.toNz"
                },
                "tehtris": {
                    "method": "blacklist",
                    "engine_name": "tehtris",
                    "engine_version": "v0.1.4",
                    "engine_update": "20230811",
                    "category": "undetected",
                    "result": null
                },
                "MicroWorld-eScan": {
                    "method": "blacklist",
                    "engine_name": "MicroWorld-eScan",
                    "engine_version": "14.0.409.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H"
                },
                "CMC": {
                    "method": "blacklist",
                    "engine_name": "CMC",
                    "engine_version": "2.4.2022.1",
                    "engine_update": "20230619",
                    "category": "undetected",
                    "result": null
                },
                "CAT-QuickHeal": {
                    "method": "blacklist",
                    "engine_name": "CAT-QuickHeal",
                    "engine_version": "22.00",
                    "engine_update": "20230810",
                    "category": "malicious",
                    "result": "Trojan.MauvaiseRI.S5244154"
                },
                "McAfee": {
                    "method": "blacklist",
                    "engine_name": "McAfee",
                    "engine_version": "6.0.6.653",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom-WannaCry!C46DF827F06F"
                },
                "Malwarebytes": {
                    "method": "blacklist",
                    "engine_name": "Malwarebytes",
                    "engine_version": "4.5.5.54",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "CVE20170147.Trojan.Exploit.DDS"
                },
                "VIPRE": {
                    "method": "blacklist",
                    "engine_name": "VIPRE",
                    "engine_version": "6.0.0.35",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H"
                },
                "Sangfor": {
                    "method": "blacklist",
                    "engine_name": "Sangfor",
                    "engine_version": "2.23.0.0",
                    "engine_update": "20230724",
                    "category": "malicious",
                    "result": "Ransom.Win32.Wannacrypt_0.se2"
                },
                "K7AntiVirus": {
                    "method": "blacklist",
                    "engine_name": "K7AntiVirus",
                    "engine_version": "12.106.49247",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan ( 005324731 )"
                },
                "BitDefender": {
                    "method": "blacklist",
                    "engine_name": "BitDefender",
                    "engine_version": "7.2",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H"
                },
                "K7GW": {
                    "method": "blacklist",
                    "engine_name": "K7GW",
                    "engine_version": "12.106.49245",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan ( 005324731 )"
                },
                "Cybereason": {
                    "method": "blacklist",
                    "engine_name": "Cybereason",
                    "engine_version": "1.2.449",
                    "engine_update": "20210330",
                    "category": "malicious",
                    "result": "malicious.7f06ff"
                },
                "Arcabit": {
                    "method": "blacklist",
                    "engine_name": "Arcabit",
                    "engine_version": "2022.0.0.18",
                    "engine_update": "20230805",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H"
                },
                "Baidu": {
                    "method": "blacklist",
                    "engine_name": "Baidu",
                    "engine_version": "1.0.0.2",
                    "engine_update": "20190318",
                    "category": "malicious",
                    "result": "Win32.Worm.Rbot.a"
                },
                "VirIT": {
                    "method": "blacklist",
                    "engine_name": "VirIT",
                    "engine_version": "9.5.512",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Win32.Genus.QGO"
                },
                "Cyren": {
                    "method": "blacklist",
                    "engine_name": "Cyren",
                    "engine_version": "6.5.1.2",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "W32/WannaCrypt.E.gen!Eldorado"
                },
                "Symantec": {
                    "method": "blacklist",
                    "engine_name": "Symantec",
                    "engine_version": "1.20.0.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom.Wannacry"
                },
                "Elastic": {
                    "method": "blacklist",
                    "engine_name": "Elastic",
                    "engine_version": "4.0.104",
                    "engine_update": "20230809",
                    "category": "malicious",
                    "result": "malicious (high confidence)"
                },
                "ESET-NOD32": {
                    "method": "blacklist",
                    "engine_name": "ESET-NOD32",
                    "engine_version": "27723",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "a variant of Win32/Exploit.CVE-2017-0147.A"
                },
                "APEX": {
                    "method": "blacklist",
                    "engine_name": "APEX",
                    "engine_version": "6.442",
                    "engine_update": "20230810",
                    "category": "malicious",
                    "result": "Malicious"
                },
                "TrendMicro-HouseCall": {
                    "method": "blacklist",
                    "engine_name": "TrendMicro-HouseCall",
                    "engine_version": "10.0.0.1040",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom_WCRY.SMALYM"
                },
                "Paloalto": {
                    "method": "blacklist",
                    "engine_name": "Paloalto",
                    "engine_version": "0.9.0.1003",
                    "engine_update": "20230811",
                    "category": "undetected",
                    "result": null
                },
                "ClamAV": {
                    "method": "blacklist",
                    "engine_name": "ClamAV",
                    "engine_version": "1.1.0.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Win.Ransomware.Wanna-9769986-0"
                },
                "Kaspersky": {
                    "method": "blacklist",
                    "engine_name": "Kaspersky",
                    "engine_version": "22.0.1.28",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan-Ransom.Win32.Wanna.m"
                },
                "Alibaba": {
                    "method": "blacklist",
                    "engine_name": "Alibaba",
                    "engine_version": "0.3.0.5",
                    "engine_update": "20190527",
                    "category": "malicious",
                    "result": "Ransom:Win32/WannaCry.398"
                },
                "NANO-Antivirus": {
                    "method": "blacklist",
                    "engine_name": "NANO-Antivirus",
                    "engine_version": "1.0.146.25796",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Win32.Wanna.epclsl"
                },
                "ViRobot": {
                    "method": "blacklist",
                    "engine_name": "ViRobot",
                    "engine_version": "2014.3.20.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Win32.WannaCry.3723264.A"
                },
                "Rising": {
                    "method": "blacklist",
                    "engine_name": "Rising",
                    "engine_version": "25.0.0.27",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Exploit.EternalBlue!1.AAED (CLASSIC)"
                },
                "TACHYON": {
                    "method": "blacklist",
                    "engine_name": "TACHYON",
                    "engine_version": "2023-08-11.02",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom/W32.WannaCry.Zen"
                },
                "Sophos": {
                    "method": "blacklist",
                    "engine_name": "Sophos",
                    "engine_version": "2.3.1.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Mal/Wanna-A"
                },
                "F-Secure": {
                    "method": "blacklist",
                    "engine_name": "F-Secure",
                    "engine_version": "18.10.1137.128",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.TR/Ransom.Gen"
                },
                "DrWeb": {
                    "method": "blacklist",
                    "engine_name": "DrWeb",
                    "engine_version": "7.0.60.6220",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Encoder.11432"
                },
                "Zillya": {
                    "method": "blacklist",
                    "engine_name": "Zillya",
                    "engine_version": "2.0.0.4935",
                    "engine_update": "20230810",
                    "category": "malicious",
                    "result": "Trojan.Wanna.Win32.4725"
                },
                "TrendMicro": {
                    "method": "blacklist",
                    "engine_name": "TrendMicro",
                    "engine_version": "11.0.0.1006",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom_WCRY.SMALYM"
                },
                "McAfee-GW-Edition": {
                    "method": "blacklist",
                    "engine_name": "McAfee-GW-Edition",
                    "engine_version": "v2021.2.0+4045",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "BehavesLike.Win32.Backdoor.vz"
                },
                "Trapmine": {
                    "method": "blacklist",
                    "engine_name": "Trapmine",
                    "engine_version": "4.0.14.90",
                    "engine_update": "20230718",
                    "category": "malicious",
                    "result": "malicious.high.ml.score"
                },
                "FireEye": {
                    "method": "blacklist",
                    "engine_name": "FireEye",
                    "engine_version": "35.24.1.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Generic.mg.c46df827f06ffa3f"
                },
                "Emsisoft": {
                    "method": "blacklist",
                    "engine_name": "Emsisoft",
                    "engine_version": "2022.6.0.32461",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H (B)"
                },
                "Ikarus": {
                    "method": "blacklist",
                    "engine_name": "Ikarus",
                    "engine_version": "6.1.14.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Exploit.CVE-2017-0147"
                },
                "Jiangmin": {
                    "method": "blacklist",
                    "engine_name": "Jiangmin",
                    "engine_version": "16.0.100",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.WanaCry.i"
                },
                "Webroot": {
                    "method": "blacklist",
                    "engine_name": "Webroot",
                    "engine_version": "1.0.0.403",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "W32.Ransom.Wannacry"
                },
                "Google": {
                    "method": "blacklist",
                    "engine_name": "Google",
                    "engine_version": "1691762519",
                    "engine_update": "20230811",
                    "category": "undetected",
                    "result": null
                },
                "Avira": {
                    "method": "blacklist",
                    "engine_name": "Avira",
                    "engine_version": "8.3.3.16",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "TR/Ransom.Gen"
                },
                "Antiy-AVL": {
                    "method": "blacklist",
                    "engine_name": "Antiy-AVL",
                    "engine_version": "3.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan[Ransom]/Win32.Wanna"
                },
                "Gridinsoft": {
                    "method": "blacklist",
                    "engine_name": "Gridinsoft",
                    "engine_version": "1.0.132.174",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom.Win32.WannaCrypt.sm!s3"
                },
                "Xcitium": {
                    "method": "blacklist",
                    "engine_name": "Xcitium",
                    "engine_version": "35904",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "TrojWare.Win32.WannaCry.jet@714um4"
                },
                "Microsoft": {
                    "method": "blacklist",
                    "engine_name": "Microsoft",
                    "engine_version": "1.1.23070.1005",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Ransom:Win32/WannaCrypt.H"
                },
                "SUPERAntiSpyware": {
                    "method": "blacklist",
                    "engine_name": "SUPERAntiSpyware",
                    "engine_version": "5.6.0.1032",
                    "engine_update": "20230808",
                    "category": "undetected",
                    "result": null
                },
                "ZoneAlarm": {
                    "method": "blacklist",
                    "engine_name": "ZoneAlarm",
                    "engine_version": "1.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan-Ransom.Win32.Wanna.m"
                },
                "GData": {
                    "method": "blacklist",
                    "engine_name": "GData",
                    "engine_version": "A:25.36349B:27.32743",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Win32.Trojan-Ransom.WannaCry.K"
                },
                "Cynet": {
                    "method": "blacklist",
                    "engine_name": "Cynet",
                    "engine_version": "4.0.0.27",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Malicious (score: 100)"
                },
                "AhnLab-V3": {
                    "method": "blacklist",
                    "engine_name": "AhnLab-V3",
                    "engine_version": "3.24.0.10447",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan/Win32.WannaCryptor.C2333701"
                },
                "Acronis": {
                    "method": "blacklist",
                    "engine_name": "Acronis",
                    "engine_version": "1.2.0.119",
                    "engine_update": "20230727",
                    "category": "undetected",
                    "result": null
                },
                "VBA32": {
                    "method": "blacklist",
                    "engine_name": "VBA32",
                    "engine_version": "5.0.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Hoax.Wanna"
                },
                "ALYac": {
                    "method": "blacklist",
                    "engine_name": "ALYac",
                    "engine_version": "1.1.3.1",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Ransom.WannaCryptor.H"
                },
                "MAX": {
                    "method": "blacklist",
                    "engine_name": "MAX",
                    "engine_version": "2023.1.4.1",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "malware (ai score=100)"
                },
                "DeepInstinct": {
                    "method": "blacklist",
                    "engine_name": "DeepInstinct",
                    "engine_version": "3.1.0.15",
                    "engine_update": "20230806",
                    "category": "malicious",
                    "result": "MALICIOUS"
                },
                "Cylance": {
                    "method": "blacklist",
                    "engine_name": "Cylance",
                    "engine_version": "2.0.0.0",
                    "engine_update": "20230726",
                    "category": "malicious",
                    "result": "unsafe"
                },
                "Panda": {
                    "method": "blacklist",
                    "engine_name": "Panda",
                    "engine_version": "4.6.4.2",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trj/RansomGen.A"
                },
                "Zoner": {
                    "method": "blacklist",
                    "engine_name": "Zoner",
                    "engine_version": "2.2.2.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan.Win32.80326"
                },
                "Tencent": {
                    "method": "blacklist",
                    "engine_name": "Tencent",
                    "engine_version": "1.0.0.1",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan-Ransom.Win32.WannaCry.b"
                },
                "Yandex": {
                    "method": "blacklist",
                    "engine_name": "Yandex",
                    "engine_version": "5.5.2.24",
                    "engine_update": "20230811",
                    "category": "undetected",
                    "result": null
                },
                "SentinelOne": {
                    "method": "blacklist",
                    "engine_name": "SentinelOne",
                    "engine_version": "23.3.0.3",
                    "engine_update": "20230705",
                    "category": "malicious",
                    "result": "Static AI - Malicious PE"
                },
                "MaxSecure": {
                    "method": "blacklist",
                    "engine_name": "MaxSecure",
                    "engine_version": "1.0.0.1",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Trojan-Ransom.Win32.Wanna.m"
                },
                "Fortinet": {
                    "method": "blacklist",
                    "engine_name": "Fortinet",
                    "engine_version": "None",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "W32/WannaCryptor.H!tr.ransom"
                },
                "BitDefenderTheta": {
                    "method": "blacklist",
                    "engine_name": "BitDefenderTheta",
                    "engine_version": "7.2.37796.0",
                    "engine_update": "20230810",
                    "category": "malicious",
                    "result": "Gen:NN.ZexaF.36350.@tZ@amkmdH"
                },
                "AVG": {
                    "method": "blacklist",
                    "engine_name": "AVG",
                    "engine_version": "23.8.8378.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Sf:WNCryLdr-A [Trj]"
                },
                "Avast": {
                    "method": "blacklist",
                    "engine_name": "Avast",
                    "engine_version": "23.8.8378.0",
                    "engine_update": "20230811",
                    "category": "malicious",
                    "result": "Sf:WNCryLdr-A [Trj]"
                },
                "CrowdStrike": {
                    "method": "blacklist",
                    "engine_name": "CrowdStrike",
                    "engine_version": "1.0",
                    "engine_update": "20220812",
                    "category": "malicious",
                    "result": "win/malicious_confidence_100% (W)"
                },
                "Trustlook": {
                    "method": "blacklist",
                    "engine_name": "Trustlook",
                    "engine_version": "1.0",
                    "engine_update": "20230811",
                    "category": "type-unsupported",
                    "result": null
                },
                "SymantecMobileInsight": {
                    "method": "blacklist",
                    "engine_name": "SymantecMobileInsight",
                    "engine_version": "2.0",
                    "engine_update": "20230119",
                    "category": "type-unsupported",
                    "result": null
                },
                "BitDefenderFalx": {
                    "method": "blacklist",
                    "engine_name": "BitDefenderFalx",
                    "engine_version": "2.0.936",
                    "engine_update": "20230801",
                    "category": "type-unsupported",
                    "result": null
                },
                "Avast-Mobile": {
                    "method": "blacklist",
                    "engine_name": "Avast-Mobile",
                    "engine_version": "230810-00",
                    "engine_update": "20230811",
                    "category": "type-unsupported",
                    "result": null
                }
            },
            "sandbox_verdicts": {
                "VMRay": {
                    "category": "malicious",
                    "sandbox_name": "VMRay",
                    "malware_classification": [
                        "RANSOM"
                    ],
                    "malware_names": [
                        "Mal/Generic-S",
                        "WannaCry"
                    ]
                },
                "C2AE": {
                    "category": "malicious",
                    "confidence": 70,
                    "sandbox_name": "C2AE",
                    "malware_classification": [
                        "RANSOM"
                    ],
                    "malware_names": [
                        "WannaCry_KillSwitch"
                    ]
                },
                "Yomi Hunter": {
                    "category": "malicious",
                    "sandbox_name": "Yomi Hunter",
                    "malware_classification": [
                        "MALWARE"
                    ]
                }
            },
            "first_submission_date": 1682655763,
            "total_votes": {
                "harmless": 0,
                "malicious": 1
            },
            "packers": {
                "PEiD": "Microsoft Visual C++"
            },
            "vhash": "076046651d6f10b8z201cpz31zd025z",
            "ssdeep": "24576:gbLgddQhfdmMSirYbcMNgef0A/TwSfVcYG3K/cJHlnFR+IGNe8j3Iz:gnAQqMSPbcBVALNiXicJFFRGNzj3",
            "type_extension": "exe",
            "md5": "c46df827f06ffa3f144713fa6ee077e8",
            "creation_date": 1290243788,
            "crowdsourced_yara_results": [
                {
                    "ruleset_id": "000fd39f0d",
                    "rule_name": "WannaCry_Ransomware",
                    "ruleset_name": "crime_wannacry",
                    "description": "Detects WannaCry Ransomware",
                    "author": "Florian Roth (Nextron Systems) (with the help of binar.ly)",
                    "source": "https://github.com/Neo23x0/signature-base"
                },
                {
                    "ruleset_id": "0056142681",
                    "rule_name": "Win32_Ransomware_WannaCry",
                    "ruleset_name": "Win32.Ransomware.WannaCry",
                    "description": "Yara rule that detects WannaCry ransomware.",
                    "author": "ReversingLabs",
                    "source": "https://github.com/reversinglabs/reversinglabs-yara-rules"
                }
            ],
            "sha1": "bbb2d533f16960c0ec101121a5e6c34aed972094",
            "reputation": -1,
            "sigma_analysis_summary": {
                "Sigma Integrated Rule Set (GitHub)": {
                    "high": 0,
                    "medium": 1,
                    "critical": 0,
                    "low": 1
                }
            },
            "last_submission_date": 1695631107,
            "sha256": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851",
            "sigma_analysis_stats": {
                "high": 0,
                "medium": 1,
                "critical": 0,
                "low": 1
            },
            "last_analysis_stats": {
                "malicious": 64,
                "suspicious": 0,
                "undetected": 7,
                "harmless": 0,
                "timeout": 0,
                "confirmed-timeout": 0,
                "failure": 0,
                "type-unsupported": 4
            },
            "magic": "PE32 executable (GUI) Intel 80386, for MS Windows",
            "last_modification_date": 1695631107,
            "authentihash": "c81c233521cccd94e695ea84af3f77402781fe63f814fa2f19e0fcda3c5c275d",
            "tlsh": "T11D7623A6225C91F8C16E113490734835E6B63C6E627D964FC394AF5A0D33BA1EF38B07",
            "size": 7315456,
            "tags": [
                "peexe",
                "cve-2017-0147",
                "exploit",
                "overlay"
            ],
            "pe_info": {
                "timestamp": 1290243788,
                "imphash": "9ecee117164e0b870a53dd187cdd7174",
                "machine_type": 332,
                "entry_point": 39446,
                "overlay": {
                    "chi2": 503581760.0,
                    "filetype": "unknown",
                    "entropy": 2.2033331394195557,
                    "offset": 4304896,
                    "size": 3010560,
                    "md5": "a81947d01c93adcea93313f03f99f52b"
                },
                "sections": [
                    {
                        "name": ".text",
                        "chi2": 514019.44,
                        "virtual_address": 4096,
                        "flags": "rx",
                        "raw_size": 36864,
                        "entropy": 6.13,
                        "virtual_size": 35786,
                        "md5": "c95e885e364bc9e09d66bd2ed8205232"
                    },
                    {
                        "name": ".rdata",
                        "chi2": 359720.38,
                        "virtual_address": 40960,
                        "flags": "r",
                        "raw_size": 4096,
                        "entropy": 3.5,
                        "virtual_size": 2456,
                        "md5": "d8037d744b539326c06e897625751cc9"
                    },
                    {
                        "name": ".data",
                        "chi2": 2564680.25,
                        "virtual_address": 45056,
                        "flags": "rw",
                        "raw_size": 159744,
                        "entropy": 6.1,
                        "virtual_size": 3164316,
                        "md5": "22a8598dc29cad7078c291e94612ce26"
                    },
                    {
                        "name": ".rsrc",
                        "chi2": 739321216.0,
                        "virtual_address": 3211264,
                        "flags": "rwx",
                        "raw_size": 4100096,
                        "entropy": 1.9,
                        "virtual_size": 4104192,
                        "md5": "5cec83ab679381b4067cd416b461f913"
                    }
                ],
                "compiler_product_versions": [
                    "id: 12, version: 7291 count=1",
                    "id: 14, version: 7299 count=4",
                    "id: 10, version: 8047 count=11",
                    "id: 11, version: 8047 count=1",
                    "id: 4, version: 8047 count=4",
                    "id: 93, version: 4035 count=11",
                    "[---] Unmarked objects count=91",
                    "[C++] VS98 (6.0) SP6 build 8804 count=1",
                    "[RES] VS98 (6.0) SP6 cvtres build 1736 count=1"
                ],
                "rich_pe_header_hash": "09c088bc95bf88e6f4df4d6ca904611b",
                "import_list": [
                    {
                        "library_name": "MSVCP60.dll",
                        "imported_functions": [
                            "??0_Lockit@std@@QAE@XZ",
                            "??1_Lockit@std@@QAE@XZ"
                        ]
                    },
                    {
                        "library_name": "iphlpapi.dll",
                        "imported_functions": [
                            "GetAdaptersInfo",
                            "GetPerAdapterInfo"
                        ]
                    },
                    {
                        "library_name": "WININET.dll",
                        "imported_functions": [
                            "InternetCloseHandle",
                            "InternetOpenA",
                            "InternetOpenUrlA"
                        ]
                    },
                    {
                        "library_name": "KERNEL32.dll",
                        "imported_functions": [
                            "CloseHandle",
                            "CreateFileA",
                            "EnterCriticalSection",
                            "ExitProcess",
                            "FindResourceA",
                            "GetCurrentThread",
                            "GetCurrentThreadId",
                            "GetFileSize",
                            "GetModuleFileNameA",
                            "GetModuleHandleA",
                            "GetModuleHandleW",
                            "GetProcAddress",
                            "GetStartupInfoA",
                            "GetTickCount",
                            "GlobalAlloc",
                            "GlobalFree",
                            "InitializeCriticalSection",
                            "InterlockedDecrement",
                            "InterlockedIncrement",
                            "LeaveCriticalSection",
                            "LoadResource",
                            "LocalAlloc",
                            "LocalFree",
                            "LockResource",
                            "MoveFileExA",
                            "QueryPerformanceCounter",
                            "QueryPerformanceFrequency",
                            "ReadFile",
                            "SizeofResource",
                            "Sleep",
                            "TerminateThread",
                            "WaitForSingleObject"
                        ]
                    },
                    {
                        "library_name": "MSVCRT.dll",
                        "imported_functions": [
                            "??2@YAPAXI@Z",
                            "__CxxFrameHandler",
                            "__dllonexit",
                            "__getmainargs",
                            "__p___argc",
                            "__p__commode",
                            "__p__fmode",
                            "__set_app_type",
                            "__setusermatherr",
                            "_acmdln",
                            "_adjust_fdiv",
                            "_beginthreadex",
                            "_controlfp",
                            "_endthreadex",
                            "_except_handler3",
                            "_exit",
                            "_ftol",
                            "_initterm",
                            "_onexit",
                            "_stricmp",
                            "_XcptFilter",
                            "exit",
                            "free",
                            "rand",
                            "sprintf",
                            "srand",
                            "strncpy",
                            "time"
                        ]
                    },
                    {
                        "library_name": "ADVAPI32.dll",
                        "imported_functions": [
                            "ChangeServiceConfig2A",
                            "CloseServiceHandle",
                            "CreateServiceA",
                            "CryptAcquireContextA",
                            "CryptGenRandom",
                            "OpenSCManagerA",
                            "OpenServiceA",
                            "RegisterServiceCtrlHandlerA",
                            "SetServiceStatus",
                            "StartServiceA",
                            "StartServiceCtrlDispatcherA"
                        ]
                    },
                    {
                        "library_name": "WS2_32.dll",
                        "imported_functions": [
                            "closesocket",
                            "connect",
                            "htonl",
                            "htons",
                            "inet_addr",
                            "inet_ntoa",
                            "ioctlsocket",
                            "ntohl",
                            "recv",
                            "select",
                            "send",
                            "socket",
                            "WSAStartup"
                        ]
                    }
                ]
            },
            "times_submitted": 5,
            "type_tag": "peexe",
            "unique_sources": 5,
            "last_analysis_date": 1691768227,
            "sigma_analysis_results": [
                {
                    "match_context": [
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "f9c50298c31c4f832377cbc3805f78dcf568835d7138c21088e56a2c5768f935",
                                "ScriptBlockId": "2c0b6e36-3b25-4c59-ad30-2b88a188bffc",
                                "MessageNumber": "1",
                                "MessageTotal": "1",
                                "Path": ""
                            }
                        }
                    ],
                    "rule_level": "medium",
                    "rule_id": "5572c8188426269a10ccb41fc8e9c8445391ac38a0917621b0a1ee05ec99aac9",
                    "rule_source": "Sigma Integrated Rule Set (GitHub)",
                    "rule_title": "Change PowerShell Policies to an Insecure Level - PowerShell",
                    "rule_description": "Detects use of Set-ExecutionPolicy to set insecure policies",
                    "rule_author": "frack113"
                },
                {
                    "match_context": [
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "8fe3efbd-853a-44c8-a79e-7fae9a574596",
                                "MessageNumber": "1",
                                "MessageTotal": "1",
                                "Path": ""
                            }
                        },
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "667efede-0083-4509-b112-8287a2f25803",
                                "MessageNumber": "1",
                                "Path": "",
                                "MessageTotal": "1"
                            }
                        },
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "4a0b66fa-b2f1-4fb5-9a0e-a402ec92b474",
                                "MessageNumber": "1",
                                "MessageTotal": "1",
                                "Path": ""
                            }
                        },
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "14fd127e-f3a9-4ac0-9228-0963d661a09e",
                                "MessageNumber": "1",
                                "Path": "",
                                "MessageTotal": "1"
                            }
                        },
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "0425096d-a6cd-4556-90f8-946ad7751f3d",
                                "MessageNumber": "1",
                                "Path": "",
                                "MessageTotal": "1"
                            }
                        },
                        {
                            "values": {
                                "EventID": "4104",
                                "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                                "ScriptBlockId": "d9c3eed0-63ae-4612-afac-c59c1340c86a",
                                "MessageNumber": "1",
                                "MessageTotal": "1",
                                "Path": ""
                            }
                        }
                    ],
                    "rule_level": "low",
                    "rule_id": "1f7f8b1e9005dd4d64cb9d30ed53ee94f68fb96262fbd72f7a0266881149c79f",
                    "rule_source": "Sigma Integrated Rule Set (GitHub)",
                    "rule_title": "Suspicious Get-WmiObject",
                    "rule_description": "The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers",
                    "rule_author": "frack113"
                }
            ]
        }
    }
},{
    "data": {
        "registry_keys_set": [
            {
                "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\SystemCertificates\\Root\\Certificates\\0174E68C97DDF1E0EEEA415EA336A163D2B61AFD\\Blob",
                "value": "5C 00 00 00 01 00 00 00 04 00 00 00 00 10 00 00 04 00 00 00 01 00 00 00 10 00 00 00 0D BE 92 DE FF 7D 36 BB 48 C4 A6 B1 15 24 95 38 0F 00 00 00 01 00 00 00 20 00 00 00 53 FE B9 19 2E D4 80 F2 09 12 4A 2C 57 D7 E8 97 7A 2E 9F 39 46 1D BF 21 4D F1 12 CB 16 02 4F A2 14 00 00 00 01 00 00 00 14 00 00 00 78 B8 30 FD 63 AC 7B 89 4A 07 3B ED F6 8A 83 9C C3 52 02 65 19 00 00 00 01 00 00 00 10 00 00 00 B5 74 AF 30 C5 C1 BA 3A 69 A7 10 02 00 82 4D D0 03 00 00 00 01 00 00 00 14 00 00 00 01 74 E6 8C 97 DD F1 E0 EE EA 41 5E A3 36 A1 63 D2 B6 1A FD 20 00 00 00 01 00 00 00 F8 05 00 00 30 82 05 F4 30 82 03 DC A0 03 02 01 02 02 09 00 E0 EA 61 4C 28 56 32 64 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 8E 31 0B 30 09 06 03 55 04 06 13 02 49 4C 31 0F 30 0D 06 03 55 04 08 0C 06 43 65 6E 74 65 72 31 0C 30 0A 06 03 55 04 07 0C 03 4C 6F 64 31 10 30 0E 06 03 55 04 0A 0C 07 47 6F 50 72 6F 78 79 31 10 30 0E 06 03 55 04 0B 0C 07 47 6F 50 72 6F 78 79 31 1A 30 18 06 03 55 04 03 0C 11 67 6F 70 72 6F 78 79 2E 67 69 74 68 75 62 2E 69 6"
            },
            {
                "key": "HKLM\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Debug\\StoreLocation",
                "value": "%LOCALAPPDATA%\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_R6TH5XGM7I1JGK2N_7db44f46f68cf9dc94a13566581589a158c_0ab57c9e"
            },
            {
                "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Debug\\StoreLocation",
                "value": "%LOCALAPPDATA%\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_R6TH5XGM7I1JGK2N_7db44f46f68cf9dc94a13566581589a158c_0ab57c9e"
            }
        ],
        "sigma_analysis_results": [
            {
                "match_context": [
                    {
                        "values": {
                            "ScriptBlockText": "f9c50298c31c4f832377cbc3805f78dcf568835d7138c21088e56a2c5768f935",
                            "MessageTotal": "1",
                            "ScriptBlockId": "2c0b6e36-3b25-4c59-ad30-2b88a188bffc",
                            "Path": "",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    }
                ],
                "rule_level": "medium",
                "rule_id": "5572c8188426269a10ccb41fc8e9c8445391ac38a0917621b0a1ee05ec99aac9",
                "rule_source": "Sigma Integrated Rule Set (GitHub)",
                "rule_title": "Change PowerShell Policies to an Insecure Level - PowerShell",
                "rule_description": "Detects use of Set-ExecutionPolicy to set insecure policies",
                "rule_author": "frack113"
            },
            {
                "match_context": [
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "MessageTotal": "1",
                            "ScriptBlockId": "8fe3efbd-853a-44c8-a79e-7fae9a574596",
                            "Path": "",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    },
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "Path": "",
                            "ScriptBlockId": "667efede-0083-4509-b112-8287a2f25803",
                            "MessageTotal": "1",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    },
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "MessageTotal": "1",
                            "ScriptBlockId": "4a0b66fa-b2f1-4fb5-9a0e-a402ec92b474",
                            "Path": "",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    },
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "Path": "",
                            "ScriptBlockId": "14fd127e-f3a9-4ac0-9228-0963d661a09e",
                            "MessageTotal": "1",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    },
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "Path": "",
                            "ScriptBlockId": "0425096d-a6cd-4556-90f8-946ad7751f3d",
                            "MessageTotal": "1",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    },
                    {
                        "values": {
                            "ScriptBlockText": "10050407a4d401ef56d5a9ece4ccb6f08bba5c1ff6dfd318e419c04a972ba748",
                            "MessageTotal": "1",
                            "ScriptBlockId": "d9c3eed0-63ae-4612-afac-c59c1340c86a",
                            "Path": "",
                            "MessageNumber": "1",
                            "EventID": "4104"
                        }
                    }
                ],
                "rule_level": "low",
                "rule_id": "1f7f8b1e9005dd4d64cb9d30ed53ee94f68fb96262fbd72f7a0266881149c79f",
                "rule_source": "Sigma Integrated Rule Set (GitHub)",
                "rule_title": "Suspicious Get-WmiObject",
                "rule_description": "The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers",
                "rule_author": "frack113"
            }
        ],
        "memory_pattern_domains": [
            "www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
        ],
        "processes_terminated": [
            "%windir%\\System32\\svchost.exe -k WerSvcGroup",
            "%windir%\\SysWOW64\\WerFault.exe -u -p 2644 -s 120",
            "wmiadap.exe /F /T /R",
            "%SAMPLEPATH%"
        ],
        "verdict_labels": [
            "WannaCry_KillSwitch",
            "Mal/Generic-S",
            "WannaCry"
        ],
        "processes_tree": [
            {
                "process_id": "2712",
                "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                "children": [
                    {
                        "process_id": "2740",
                        "name": "%windir%\\SysWOW64\\WerFault.exe -u -p 2644 -s 120"
                    }
                ]
            },
            {
                "process_id": "2984",
                "name": "wmiadap.exe /F /T /R"
            },
            {
                "process_id": "3024",
                "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
            },
            {
                "process_id": "2644",
                "name": "%SAMPLEPATH%",
                "time_offset": 1
            },
            {
                "process_id": "4368",
                "name": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" ",
                "children": [
                    {
                        "process_id": "1452",
                        "name": "C:\\Windows\\SysWOW64\\WerFault.exe -u -p 4368 -s 264"
                    },
                    {
                        "process_id": "3480",
                        "name": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "process_id": "2984",
                "name": "2d76d20cc4bacf48a91ff61eb0289024.exe",
                "time_offset": 23684
            }
        ],
        "processes_created": [
            "C:\\Windows\\SysWOW64\\WerFault.exe -u -p 4368 -s 264",
            "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
        ],
        "modules_loaded": [
            "rpcrt4",
            "SspiCli"
        ],
        "files_dropped": [
            {
                "sha256": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3",
                "type": "PE_EXE"
            },
            {
                "path": "/msdownload/update/v3/static/trustedr/en/authrootstl.cab",
                "sha256": "d015145d551ecd14916270efad773bbc9fd57fad2228d2c24559f696c961d904",
                "type": "CAB",
                "download_url": "ctldl.windowsupdate.comhttp://ctldl.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab?5d2143adce173a27"
            }
        ],
        "http_conversations": [
            {
                "url": "http://crt.sectigo.com/SectigoPublicCodeSigningCAR36.crt",
                "request_method": "GET",
                "request_headers": {
                    "User-Agent": "Microsoft-CryptoAPI/6.1",
                    "Host": "crt.sectigo.com"
                },
                "response_headers": {
                    "Content-Length": "1566",
                    "Content-Type": "application/pkix-cert"
                },
                "response_status_code": 200
            },
            {
                "url": "http://crt.sectigo.com/SectigoPublicCodeSigningRootR46.p7c",
                "request_method": "GET",
                "request_headers": {
                    "User-Agent": "Microsoft-CryptoAPI/6.1",
                    "Host": "crt.sectigo.com"
                },
                "response_headers": {
                    "Content-Length": "2848",
                    "Content-Type": "application/pkcs7-mime"
                },
                "response_status_code": 200
            }
        ],
        "verdict_confidence": 70,
        "verdicts": [
            "RANSOM",
            "MALWARE"
        ],
        "memory_pattern_urls": [
            "http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
        ],
        "mitre_attack_techniques": [
            {
                "id": "T1027.005",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "contain obfuscated stackstrings",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "contain obfuscated stackstrings"
                    }
                ]
            },
            {
                "id": "T1027",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "encode data using XOR",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "encode data using XOR"
                    }
                ]
            },
            {
                "id": "T1016",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "get socket status",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "get socket status"
                    }
                ]
            },
            {
                "id": "T1083",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "get file size",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "get file size"
                    }
                ]
            },
            {
                "id": "T1543.003",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "start service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "start service"
                    }
                ]
            },
            {
                "id": "T1543.003",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "create service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "create service"
                    }
                ]
            },
            {
                "id": "T1569.002",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "create service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "create service"
                    }
                ]
            },
            {
                "id": "T1543.003",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "persist via Windows service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "persist via Windows service"
                    }
                ]
            },
            {
                "id": "T1569.002",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "persist via Windows service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "persist via Windows service"
                    }
                ]
            },
            {
                "id": "T1129",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "link function at runtime on Windows",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "link function at runtime on Windows"
                    }
                ]
            },
            {
                "id": "T1543.003",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "modify service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "modify service"
                    }
                ]
            },
            {
                "id": "T1569.002",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "modify service",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "modify service"
                    }
                ]
            },
            {
                "id": "T1129",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "parse PE header",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "parse PE header"
                    }
                ]
            },
            {
                "id": "T1027",
                "severity": "IMPACT_SEVERITY_INFO",
                "signature_description": "encrypt data using RC4 KSA",
                "refs": [
                    {
                        "ref": "#signature_matches",
                        "value": "encrypt data using RC4 KSA"
                    }
                ]
            },
            {
                "id": "T1057",
                "signature_description": "The process attempted to detect a running debugger using common APIs"
            },
            {
                "id": "T1059",
                "signature_description": "Apparent Internal Usage of CMD.EXE"
            },
            {
                "id": "T1063",
                "signature_description": "It Tries to detect injection methods"
            }
        ],
        "signature_matches": [
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "calculate modulo 256 via x86 assembly",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "delay execution",
                "authors": [
                    "michael.hunhoff@mandiant.com",
                    "@ramen0x3f"
                ],
                "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                "refs": [
                    {
                        "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                    },
                    {
                        "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                    }
                ]
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "reference absolute stream path on Windows",
                "description": "host-interaction/file-system",
                "authors": [
                    "blas.kojusner@mandiant.com",
                    "william.ballenthin@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n",
                "refs": [
                    {
                        "ref": "https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"
                    }
                ]
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create UDP socket",
                "description": "communication/socket/udp/send",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "joakim@intezer.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create UDP socket\n    namespace: communication/socket/udp/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    mbc:\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\n    examples:\n      - 203BD48BCC18434314AD60F4C8BC21E3D3422EB0624B22B827410F9BC63B4082:0x401240\n  features:\n    - or:\n      - and:\n        - count(number(2 = AF_INET/SOCK_DGRAM)): 2 or more\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n          - api: System.Net.Sockets.Socket::ctor\n      - api: System.Net.Sockets.UdpClient::ctor\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "contain obfuscated stackstrings",
                "description": "anti-analysis/obfuscation/string/stackstring",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create TCP socket",
                "description": "communication/socket/tcp",
                "authors": [
                    "william.ballenthin@mandiant.com",
                    "joakim@intezer.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n      - property/read: System.Net.Sockets.TcpClient::Client\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create or open file",
                "authors": [
                    "michael.hunhoff@mandiant.com",
                    "joakim@intezer.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create thread",
                "description": "host-interaction/thread/create",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "michael.hunhoff@mandiant.com",
                    "joakim@intezer.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "encode data using XOR",
                "description": "data-manipulation/encoding/xor",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "generate random numbers using the Delphi LCG",
                "description": "data-manipulation/prng/lcg",
                "authors": [
                    "william.ballenthin@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: generate random numbers using the Delphi LCG\n    namespace: data-manipulation/prng/lcg\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    mbc:\n      - Cryptography::Generate Pseudo-random Sequence [C0021]\n    references:\n      - https://en.wikipedia.org/wiki/Linear_congruential_generator\n      - https://community.osr.com/discussion/130410/generating-random-numbers\n  features:\n    - and:\n      - instruction:\n        - mnemonic: imul\n        - number: 0x8088405 = multiplier a\n      - mnemonic: inc = increment c\n",
                "refs": [
                    {
                        "ref": "https://en.wikipedia.org/wiki/Linear_congruential_generator"
                    },
                    {
                        "ref": "https://community.osr.com/discussion/130410/generating-random-numbers"
                    }
                ]
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "contain loop",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "receive data on socket",
                "description": "communication/socket/receive",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "joakim@intezer.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recv\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "send data on socket",
                "description": "communication/socket/send",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "joakim@intezer.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: ws2_32.send\n      - api: ws2_32.sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: send\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "receive data",
                "description": "communication : all known techniques for receiving data from a potential C2 server",
                "authors": [
                    "william.ballenthin@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "send data",
                "description": "communication : all known techniques for sending data to a potential C2 server",
                "authors": [
                    "william.ballenthin@mandiant.com",
                    "joakim@intezer.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scope: function\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n          - match: send data to Internet\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "check for time delay via QueryPerformanceCounter",
                "description": "anti-analysis/anti-debugging/debugger-detection",
                "authors": [
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: check for time delay via QueryPerformanceCounter\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4011e0\n  features:\n    - and:\n      - count(api(kernel32.QueryPerformanceCounter)): 2 or more\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "inspect section memory permissions",
                "description": "load-code/pe : translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants",
                "authors": [
                    "@Ana06"
                ],
                "rule_src": "rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "set socket configuration",
                "description": "communication/socket",
                "authors": [
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: set socket configuration\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Set Socket Config [C0001.001]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - or:\n      - api: ws2_32.setsockopt\n      - api: ws2_32.ioctlsocket\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "get socket status",
                "description": "communication/socket",
                "authors": [
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: get socket status\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Network Configuration Discovery [T1016]\n    mbc:\n      - Communication::Socket Communication::Get Socket Status [C0001.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000C1F0\n  features:\n    - and:\n      - api: ws2_32.select\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "connect TCP socket",
                "description": "communication/socket/tcp",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "joakim@intezer.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: connect TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Connect Socket [C0001.004]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - match: create TCP socket\n      - or:\n        - api: connect\n        - api: ws2_32.connect\n        - api: ws2_32.WSAConnect\n        - api: ConnectEx\n        - and:\n          - basic block:\n            # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\n            - and:\n              - number: 0x25A207B9\n              - number: 0x4660DDF3\n              - number: 0xE576E98E\n              - number: 0x3E06748C\n          - basic block:\n            - and:\n              - api: WSAIoctl\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\n          - basic block:\n            - and:\n              - api: setsockopt\n              - number: 0xFFFF = SOL_SOCKET\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\n          # socket must be bound to ConnectEx\n          # https://gist.github.com/joeyadams/4158972\n          - api: bind\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "act as TCP client",
                "description": "communication/tcp/client",
                "authors": [
                    "william.ballenthin@mandiant.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: act as TCP client\n    namespace: communication/tcp/client\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::TCP Client [C0001.008]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - match: connect TCP socket\n      - api: System.Net.Sockets.TcpClient::ctor\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "generate random numbers via WinAPI",
                "description": "data-manipulation/prng",
                "authors": [
                    "michael.hunhoff@mandiant.com",
                    "johnk3r"
                ],
                "rule_src": "rule:\n  meta:\n    name: generate random numbers via WinAPI\n    namespace: data-manipulation/prng\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scope: function\n    mbc:\n      - Cryptography::Generate Pseudo-random Sequence::Use API [C0021.003]\n    examples:\n      - ba947eb07d8c823949316a97364d060f:0x1400031E0\n      - 3ca359f5085bb96a7950d4735b089ffe:0x403A80\n      - e59ffeaf7acb0c326e452fa30bb71a36:0x40403E\n      - 1195d0d18be9362fb8dd9e1738404c9d:0x404E90\n  features:\n    - and:\n      - or:\n        - api: BCryptGenRandom\n        - api: CryptGenRandom\n      - optional:\n        - api: BCryptOpenAlgorithmProvider\n        - api: BCryptCloseAlgorithmProvider\n        - api: CryptAquireContext\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "get file size",
                "description": "host-interaction/file-system/meta",
                "authors": [
                    "michael.hunhoff@mandiant.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "read file on Windows",
                "description": "host-interaction/file-system/read",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "initialize Winsock library",
                "description": "communication/socket",
                "authors": [
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "get service handle",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "start service",
                "description": "host-interaction/service/start",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create service",
                "description": "host-interaction/service/create",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "persist via Windows service",
                "description": "persistence/service",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - basic block:\n          - and:\n            - number: 2 = SERVICE_AUTO_START\n            - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "link function at runtime on Windows",
                "description": "linking/runtime-linking",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "move file",
                "description": "host-interaction/file-system/move",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "extract resource via kernel32 functions",
                "description": "executable/resource",
                "authors": [
                    "william.ballenthin@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - match: contain a resource (.rsrc) section\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "modify service",
                "description": "host-interaction/service/modify",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: modify service\n    namespace: host-interaction/service/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - 7D16EFD0078F22C17A4BD78B0F0CC468:0x401000\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - api: advapi32.ChangeServiceConfig\n        - api: advapi32.ChangeServiceConfig2\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "create HTTP request",
                "description": "communication/http/client",
                "authors": [
                    "michael.hunhoff@mandiant.com",
                    "anushka.virgaonkar@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: create HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - or:\n        - api: wininet.InternetOpen\n        - api: System.Net.WebRequest::Create\n        - api: System.Net.WebRequest::CreateDefault\n        - api: System.Net.WebRequest::CreateHttp\n      - optional:\n        - api: wininet.InternetCloseHandle\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "connect to URL",
                "description": "communication/http/client",
                "authors": [
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: connect to URL\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Open URL [C0002.004]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40E2F0\n  features:\n    - and:\n      - optional:\n        - match: create HTTP request\n      - api: wininet.InternetOpenUrl\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "parse PE header",
                "description": "load-code/pe",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "encrypt data using RC4 KSA",
                "description": "data-manipulation/encryption/rc4",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: encrypt data using RC4 KSA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Encryption Key::RC4 KSA [C0028.002]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403D40\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404950\n      - 2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x40646E\n  features:\n    - or:\n      - and:\n        - basic block:\n          - and:\n            - description: initialize S\n            # misses if regular loop is used,\n            # however we cannot model that a loop contains a certain number\n            - characteristic: tight loop\n            - or:\n              - number: 0xFF\n              - number: 0x100\n        - or:\n          - description: modulo 256\n          - match: calculate modulo 256 via x86 assembly\n          - basic block:\n            - and:\n              - description: modulo via zero-extended mov from 8-bit register\n              - count(mnemonic(movzx)): 2 or more\n              # avoid false positives; filter out unexpected instructions\n              - not:\n                - or:\n                  - mnemonic: shl\n                  - mnemonic: rol\n                  - characteristic: nzxor\n        - or:\n          - description: modulo key length\n          - mnemonic: div\n          - mnemonic: idiv\n      - and:\n        - description: write DWORDs instead of bytes\n        - or:\n          - number: 0x03020100\n          - number: 0xFFFEFDFC\n        - instruction:\n          - or:\n            - mnemonic: add\n            - mnemonic: sub\n          - number: 0x04040404\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "contain a resource (.rsrc) section",
                "description": "executable/pe/section/rsrc",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "contain an embedded PE file",
                "description": "executable/subfile/pe",
                "authors": [
                    "moritz.raabe@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "run as service",
                "description": "host-interaction/service",
                "authors": [
                    "moritz.raabe@mandiant.com",
                    "michael.hunhoff@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: run as service\n    namespace: host-interaction/service\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: file\n    mbc:\n      - Anti-Behavioral Analysis::Conditional Execution::Runs as Service [B0025.007]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_\n  features:\n    - or:\n      - export: ServiceMain\n      - function:\n        - or:\n          - api: RegisterServiceCtrlHandler\n          - api: RegisterServiceCtrlHandlerEx\n          - api: StartServiceCtrlDispatcher\n          - api: System.ServiceProcess.ServiceBase::Run\n"
            },
            {
                "format": "SIG_FORMAT_CAPA",
                "name": "linked against ZLIB",
                "description": "linking/static/zlib",
                "authors": [
                    "william.ballenthin@mandiant.com"
                ],
                "rule_src": "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n"
            },
            {
                "id": "vti_match_13",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"ransomware_windows_wannacry\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_12",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"WannaCry_Ransomware\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_11",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"Wanna_Cry_Ransomware_Generic\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_10",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"worm_ms17_010\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_15",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"wannacry_static_ransom\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_14",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"MS17_010_WanaCry_worm\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_7",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"wannacry_static_ransom\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_6",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"WannaCry_Ransomware\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_5",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"MS17_010_WanaCry_worm\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_4",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"Wanna_Cry_Ransomware_Generic\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_3",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"worm_ms17_010\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_2",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"WannaDecryptor\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_1",
                "description": "Reputation analysis labels the sample itself as Mal/Generic-S.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    }
                ]
            },
            {
                "id": "vti_match_0",
                "description": "(Process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe crashed.",
                "severity": "IMPACT_SEVERITY_INFO",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_9",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"WannaDecryptor\" from ruleset \"Ransomware\" in the sample file C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            },
            {
                "id": "vti_match_8",
                "format": "SIG_FORMAT_YARA",
                "description": "YARA detected \"ransomware_windows_wannacry\" from ruleset \"Ransomware\" in memory dump data from (process #1) c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe.",
                "severity": "IMPACT_SEVERITY_HIGH",
                "refs": [
                    {
                        "ref": "#files_dropped",
                        "value": "c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851"
                    },
                    {
                        "ref": "#files_dropped",
                        "value": "092a2b98ca70235ad2b3ffab390f887e61cdc09246cff809bf6d9513e35f71f3"
                    },
                    {
                        "ref": "#process_tree",
                        "value": "\"C:\\Users\\OqXZRaykm\\Desktop\\c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851.exe\" "
                    }
                ]
            }
        ],
        "dns_lookups": [
            {
                "hostname": "crt.sectigo.com",
                "resolved_ips": [
                    "91.199.212.52"
                ]
            }
        ],
        "command_executions": [
            "%SAMPLEPATH%"
        ],
        "attack_techniques": {
            "T1027.005": [
                {
                    "severity": "INFO",
                    "description": "contain obfuscated stackstrings"
                }
            ],
            "T1027": [
                {
                    "severity": "INFO",
                    "description": "encode data using XOR"
                },
                {
                    "severity": "INFO",
                    "description": "encrypt data using RC4 KSA"
                }
            ],
            "T1016": [
                {
                    "severity": "INFO",
                    "description": "get socket status"
                }
            ],
            "T1083": [
                {
                    "severity": "INFO",
                    "description": "get file size"
                }
            ],
            "T1543.003": [
                {
                    "severity": "INFO",
                    "description": "start service"
                },
                {
                    "severity": "INFO",
                    "description": "create service"
                },
                {
                    "severity": "INFO",
                    "description": "persist via Windows service"
                },
                {
                    "severity": "INFO",
                    "description": "modify service"
                }
            ],
            "T1569.002": [
                {
                    "severity": "INFO",
                    "description": "create service"
                },
                {
                    "severity": "INFO",
                    "description": "persist via Windows service"
                },
                {
                    "severity": "INFO",
                    "description": "modify service"
                }
            ],
            "T1129": [
                {
                    "severity": "INFO",
                    "description": "link function at runtime on Windows"
                },
                {
                    "severity": "INFO",
                    "description": "parse PE header"
                }
            ],
            "T1057": [
                {
                    "severity": "UNKNOWN",
                    "description": "The process attempted to detect a running debugger using common APIs"
                }
            ],
            "T1059": [
                {
                    "severity": "UNKNOWN",
                    "description": "Apparent Internal Usage of CMD.EXE"
                }
            ],
            "T1063": [
                {
                    "severity": "UNKNOWN",
                    "description": "It Tries to detect injection methods"
                }
            ]
        }
    }
},{
    "data": {
        "CAPA": {
            "tactics": [
                {
                    "id": "TA0005",
                    "name": "Defense Evasion",
                    "link": "https://attack.mitre.org/tactics/TA0005/",
                    "description": "The adversary is trying to avoid being detected.\n\nDefense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics\u2019 techniques are cross-listed here when those techniques include the added benefit of subverting defenses. ",
                    "techniques": [
                        {
                            "id": "T1027.005",
                            "name": "Indicator Removal from Tools",
                            "link": "https://attack.mitre.org/techniques/T1027/005/",
                            "description": "Adversaries may remove indicators from tools if they believe their malicious tool was detected, quarantined, or otherwise curtailed. They can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems.\nA good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature, and then re-use the malware.",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "contain obfuscated stackstrings"
                                }
                            ]
                        },
                        {
                            "id": "T1027",
                            "name": "Obfuscated Files or Information",
                            "link": "https://attack.mitre.org/techniques/T1027/",
                            "description": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. \nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and Deobfuscate/Decode Files or Information for User Execution. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.  Adversaries may also use compressed or archived scripts, such as JavaScript. \nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery.  Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. \nAdversaries may also abuse Command Obfuscation to obscure commands executed from payloads or directly via Command and Scripting Interpreter. Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms.   ",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "encode data using XOR"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "encrypt data using RC4 KSA"
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": "TA0007",
                    "name": "Discovery",
                    "link": "https://attack.mitre.org/tactics/TA0007/",
                    "description": "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what\u2019s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
                    "techniques": [
                        {
                            "id": "T1016",
                            "name": "System Network Configuration Discovery",
                            "link": "https://attack.mitre.org/techniques/T1016/",
                            "description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route.\nAdversaries may also leverage a Network Device CLI on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. show ip route, show ip interface).\nAdversaries may use the information from System Network Configuration Discovery during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "get socket status"
                                }
                            ]
                        },
                        {
                            "id": "T1083",
                            "name": "File and Directory Discovery",
                            "link": "https://attack.mitre.org/techniques/T1083/",
                            "description": "Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from File and Directory Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\nMany command shell utilities can be used to obtain this information. Examples include dir, tree, ls, find, and locate. Custom tools may also be used to gather file and directory information and interact with the Native API. Adversaries may also leverage a Network Device CLI on network devices to gather file and directory information (e.g. dir, show flash, and/or nvram).",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "get file size"
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": "TA0003",
                    "name": "Persistence",
                    "link": "https://attack.mitre.org/tactics/TA0003/",
                    "description": "The adversary is trying to maintain their foothold.\n\nPersistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. Techniques used for persistence include any access, action, or configuration changes that let them maintain their foothold on systems, such as replacing or hijacking legitimate code or adding startup code. ",
                    "techniques": [
                        {
                            "id": "T1543.003",
                            "name": "Windows Service",
                            "link": "https://attack.mitre.org/techniques/T1543/003/",
                            "description": "Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.\nAdversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. \nAdversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: .sys) to disk, the payload can be loaded and registered via Native API functions such as CreateServiceW() (or manually via functions such as ZwLoadDriver() and ZwSetValueKey()), by creating the required service Registry values (i.e. Modify Registry), or by using command-line utilities such as PnPUtil.exe. Adversaries may leverage these drivers as Rootkits to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as \"Bring Your Own Vulnerable Driver\" (BYOVD)) as part of Exploitation for Privilege Escalation.\nServices may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through Service Execution. To make detection analysis more challenging, malicious services may also incorporate Masquerade Task or Service (ex: using a service and/or payload name related to a legitimate OS or benign software component).",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "start service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "create service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "persist via Windows service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "modify service"
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": "TA0004",
                    "name": "Privilege Escalation",
                    "link": "https://attack.mitre.org/tactics/TA0004/",
                    "description": "The adversary is trying to gain higher-level permissions.\n\nPrivilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. Adversaries can often enter and explore a network with unprivileged access but require elevated permissions to follow through on their objectives. Common approaches are to take advantage of system weaknesses, misconfigurations, and vulnerabilities. Examples of elevated access include: \n\n* SYSTEM/root level\n* local administrator\n* user account with admin-like access \n* user accounts with access to specific system or perform specific function\n\nThese techniques often overlap with Persistence techniques, as OS features that let an adversary persist can execute in an elevated context.  ",
                    "techniques": [
                        {
                            "id": "T1543.003",
                            "name": "Windows Service",
                            "link": "https://attack.mitre.org/techniques/T1543/003/",
                            "description": "Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry.\nAdversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. \nAdversaries may also use services to install and execute malicious drivers. For example, after dropping a driver file (ex: .sys) to disk, the payload can be loaded and registered via Native API functions such as CreateServiceW() (or manually via functions such as ZwLoadDriver() and ZwSetValueKey()), by creating the required service Registry values (i.e. Modify Registry), or by using command-line utilities such as PnPUtil.exe. Adversaries may leverage these drivers as Rootkits to hide the presence of malicious activity on a system. Adversaries may also load a signed yet vulnerable driver onto a compromised machine (known as \"Bring Your Own Vulnerable Driver\" (BYOVD)) as part of Exploitation for Privilege Escalation.\nServices may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges. Adversaries may also directly start services through Service Execution. To make detection analysis more challenging, malicious services may also incorporate Masquerade Task or Service (ex: using a service and/or payload name related to a legitimate OS or benign software component).",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "start service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "create service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "persist via Windows service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "modify service"
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": "TA0002",
                    "name": "Execution",
                    "link": "https://attack.mitre.org/tactics/TA0002/",
                    "description": "The adversary is trying to run malicious code.\n\nExecution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. ",
                    "techniques": [
                        {
                            "id": "T1569.002",
                            "name": "Service Execution",
                            "link": "https://attack.mitre.org/techniques/T1569/002/",
                            "description": "Adversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (services.exe) is an interface to manage and manipulate services. The service control manager is accessible to users via GUI components as well as system utilities such as sc.exe and Net.\nPsExec can also be used to execute commands or payloads via a temporary Windows service created through the service control manager API. Tools such as PsExec and sc.exe can accept remote servers as arguments and may be used to conduct remote execution.\nAdversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction with Windows Service during service persistence or privilege escalation.",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "create service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "persist via Windows service"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "modify service"
                                }
                            ]
                        },
                        {
                            "id": "T1129",
                            "name": "Shared Modules",
                            "link": "https://attack.mitre.org/techniques/T1129/",
                            "description": "Adversaries may execute malicious payloads via loading shared modules. Shared modules are executable files that are loaded into processes to provide access to reusable code, such as specific custom functions or invoking OS API functions (i.e., Native API).\nAdversaries may use this functionality as a way to execute arbitrary payloads on a victim system. For example, adversaries can modularize functionality of their malware into shared objects that perform various functions such as managing C2 network communications or execution of specific actions on objective.\nThe Linux & macOS module loader can load and execute shared objects from arbitrary local paths. This functionality resides in dlfcn.h in functions such as dlopen and dlsym. Although macOS can execute .so files, common practice uses .dylib files.\nThe Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows Native API which is called from functions like LoadLibrary at run time.",
                            "signatures": [
                                {
                                    "severity": "INFO",
                                    "description": "link function at runtime on Windows"
                                },
                                {
                                    "severity": "INFO",
                                    "description": "parse PE header"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "Yomi Hunter": {
            "tactics": [
                {
                    "id": "TA0007",
                    "name": "Discovery",
                    "link": "https://attack.mitre.org/tactics/TA0007/",
                    "description": "The adversary is trying to figure out your environment.\n\nDiscovery consists of techniques an adversary may use to gain knowledge about the system and internal network. These techniques help adversaries observe the environment and orient themselves before deciding how to act. They also allow adversaries to explore what they can control and what\u2019s around their entry point in order to discover how it could benefit their current objective. Native operating system tools are often used toward this post-compromise information-gathering objective. ",
                    "techniques": [
                        {
                            "id": "T1057",
                            "name": "Process Discovery",
                            "link": "https://attack.mitre.org/techniques/T1057/",
                            "description": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\nIn Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or Get-Process via PowerShell. Information about processes can also be extracted from the output of Native API calls such as CreateToolhelp32Snapshot. In Mac and Linux, this is accomplished with the ps command. Adversaries may also opt to enumerate processes via /proc.\nOn network devices, Network Device CLI commands such as show processes can be used to display current running processes.",
                            "signatures": [
                                {
                                    "severity": "UNKNOWN",
                                    "description": "The process attempted to detect a running debugger using common APIs"
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": "TA0002",
                    "name": "Execution",
                    "link": "https://attack.mitre.org/tactics/TA0002/",
                    "description": "The adversary is trying to run malicious code.\n\nExecution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. ",
                    "techniques": [
                        {
                            "id": "T1059",
                            "name": "Command and Scripting Interpreter",
                            "link": "https://attack.mitre.org/techniques/T1059/",
                            "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of Unix Shell while Windows installations include the Windows Command Shell and PowerShell.\nThere are also cross-platform interpreters such as Python, as well as those commonly associated with client applications such as JavaScript and Visual Basic.\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in Initial Access payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various Remote Services in order to achieve remote Execution.",
                            "signatures": [
                                {
                                    "severity": "UNKNOWN",
                                    "description": "Apparent Internal Usage of CMD.EXE"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/c6886613d03744ac0fd42ce9530552d60ffcb9883d6f0308ac209ed775101851/behaviour_mitre_trees"
    }
}]